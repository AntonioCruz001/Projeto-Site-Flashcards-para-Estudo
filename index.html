<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flash Cards</title>

    <style>
        * {
            /* Procurar como fazer var em CSS!! */
            --bgc-div-frente: #6ad6bf;
            --bgc-div-verso: #eab276;
            margin: 0px;
            padding: 0px;
        }

        header {
            text-align: center;
            padding: 30px;
            margin-bottom: 10px;
            background-color: rgb(189, 209, 226);
        }

        #form-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 25px;
            background-color: rgb(152, 165, 203);
            padding: 30px;
        }

        #formulario {
            display: flex;
            flex-direction: column;
            gap: 20px;
            width: 500px;
            margin: 0px auto;
        }

        #config-container {
            display: flex;
            flex-direction: row;
            justify-content: center;
            /* gap: 20px; */
            /* width: 500px; */
        }

        #apagar {
            padding: 5px;
            color: rgb(255, 237, 122);
            background-color: rgb(234, 126, 37);
            /* border: none; */
            border: 2px solid salmon;
            border-radius: 8px;

            transition: background-color .3s ease-in-out, color .3s ease-in-out;
        }

        #apagar:hover {
            color: rgb(3, 52, 83);
            background-color: rgb(241, 182, 54);
            transition: background-color .3s ease-in-out, color .3s ease-in-out;
        }


        #apagar:active {
            color: rgb(14, 91, 132);
            background-color: rgb(253, 231, 122);
            transition: background-color .0s ease-in-out, color .0s ease-in-out;
        }

        #flashCards-container {
            box-sizing: border-box;
            margin: 20px 1px;
            display: grid;
            grid-template-columns: 33% 33% 33%;
            gap: .8% .4%;
            /* width: 100vw; */
        }

        .card {
            display: flex;
            justify-content: center;
            align-items: center;
            box-sizing: border-box;
            background-color: var(--bgc-div-frente);
            height: 140px;

            /* border: 2px solid black; */
            border-radius: 10px;
            text-align: center;

            user-select: none;
        }

        /* #formulario:nth-child {} */
    </style>
</head>

<body>

    <header>
        <h1>Flash Cards para Estudo</h1>
    </header>

    <div id="form-container">
        <form id="formulario">
            <input type="text" id="frente" class="teste" placeholder="Frente">
            <input type="text" id="verso" placeholder="Verso">
            <button id="confirmar" type="button">Confirmar</button>
        </form>
        <div id="config-container">
            <button id="apagar" type="button">Apagar todos os cards</button>
        </div>
    </div>

    <div id="flashCards-container">

    </div>








    <script>
        // Necessário impedir registro vazio
        const listaDeCards = JSON.parse(localStorage.getItem('listaDeCards')) || [];
        const frente = document.getElementById('frente')
        const verso = document.getElementById('verso')
        const submit = document.getElementById('confirmar')
        const apagar = document.getElementById('apagar')
        const flashCardContainer = document.getElementById('flashCards-container')
        const cards = document.querySelectorAll('.card')


        const inputFrente = document.getElementById('frente')
        const inputVerso = document.getElementById('verso')

        let lengthDaLista = listaDeCards.length
        let i = lengthDaLista

        // Criando as divs com os dados do localStorage
        listaDeCards.forEach(card => {
            const div = document.createElement('div');
            div.setAttribute('class', 'card');
            div.setAttribute('lado', 'frente');
            div.setAttribute('index', `${listaDeCards.indexOf(card)}`)
            // item 0 de cada obj do array
            // div.textContent = card.frente;

            const paragrafo = document.createElement('p');
            paragrafo.setAttribute('class', 'texto-card');
            paragrafo.textContent = card.frente;

            flashCardContainer.appendChild(div);
            div.appendChild(paragrafo);
        });


        // Funcionalidade de virar os cards ue já estão na memória
        // getAttribute retorna o valor do atributo
        const card = document.querySelectorAll('.card')
        card.forEach(div => {
            div.addEventListener('click', () => {
                if (div.getAttribute('lado') == 'frente') {
                    div.style.backgroundColor = 'var(--bgc-div-verso)';
                    // div.textContent = 'Verso';
                    div.textContent = listaDeCards[div.getAttribute('index')].verso;
                    div.setAttribute('lado', 'verso');
                } else if (div.getAttribute('lado') == 'verso') {
                    div.style.backgroundColor = 'var(--bgc-div-frente)';
                    div.textContent = listaDeCards[div.getAttribute('index')].frente;
                    div.setAttribute('lado', 'frente');
                }
            })
        })


        // Registrando um flash card
        submit.onclick = function (e) {
            if ((inputFrente.value == "")) {
                inputFrente.focus()
            } else if ((inputVerso.value == "")) {
                inputVerso.focus()
            } else {

                const div = document.createElement('div');

                div.setAttribute('class', 'card');
                div.setAttribute('lado', 'frente');
                // div.textContent = frente.value;

                const paragrafo = document.createElement('p');
                paragrafo.setAttribute('class', 'texto-card');
                paragrafo.textContent = frente.value;

                // adicionando o event listener
                div.addEventListener('click', () => {
                    // teste

                    if (div.getAttribute('lado') == 'frente') {
                        div.style.backgroundColor = 'var(--bgc-div-verso)';
                        div.textContent = listaDeCards[div.getAttribute('index')].verso;
                        div.setAttribute('lado', 'verso');
                    } else if (div.getAttribute('lado') == 'verso') {
                        div.style.backgroundColor = 'var(--bgc-div-frente)';
                        div.textContent = listaDeCards[div.getAttribute('index')].frente;
                        div.setAttribute('lado', 'frente');
                    }
                }
                )

                // document.getElementById('flashCards-container').appendChild(div);

                flashCardContainer.appendChild(div);
                div.appendChild(paragrafo);

                const obj = { 'frente': frente.value, 'verso': verso.value };
                listaDeCards.push(obj);

                localStorage.setItem('listaDeCards', JSON.stringify(listaDeCards));

                const listaIndice = JSON.parse(localStorage.getItem('listaDeCards'))

                div.setAttribute('index', `${listaIndice.length - 1}` || '0')
                // i += 1

                document.querySelector('#formulario').reset();

            }
        }
        // Erro: este trecho é lido no inicio mas não afeta 
        // as divs criadas com createElement!



        // apagarLocalStorage()
        apagar.onclick = function apagarLocalStorage() {
            if (confirm('Deseja apagar todos os cards?')) {
                flashCardContainer.innerHTML = '';
                localStorage.removeItem('listaDeCards')
            }
        }

    </script>
</body>

</html>